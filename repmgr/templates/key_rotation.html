{% extends "base.html" %}
{% from 'macros.html' import render_radio_field, render_field %}
{% block content %}
<h2 class="page-header">oxAuth Key Rotation</h2>
<form action="{{ url_for('key_rotation') }}" method="POST">
    {{ form.csrf_token }}
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">Key Rotation</h3>
        </div>
        <div class="panel-body">
            <div class="form-group {{ 'has-error' if form.interval.errors else '' }}">
                {{ form.interval.label(class="control-label") }}
                <div class="input-group">
                    {{ form.interval(class="form-control") }}
                    <span class="input-group-addon">days</span>
                </div>
                {% for error in form.interval.errors %}
                    <p class="help-block">{{ error }}</p>
                {% endfor %}
            </div>
            <div class="form-group {{ 'has-error' if form.type.errors else '' }}">
                {{ form.type.label(class="control-label") }}
                <div class="input-group">
                    {{ render_radio_field(form.type, rotation.type) }}
                </div>
                {% for error in form.type.errors %}
                    <p class="help-block">{{ error }}</p>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">oxEleven Integration</h3>
        </div>
        <div class="panel-body">
            <div class="form-group {{ 'has-error' if form.oxeleven_url.errors else '' }}">
                <div class="input-group">
                    {{ form.oxeleven_url.label(class="control-label") }}
                    <p class="help-block">URL of oxEleven app. The value will be used only if oxEleven is selected as rotation type.</p>
                    {{ form.oxeleven_url(class="form-control") }}
                </div>
                {% for error in form.oxeleven_url.errors %}
                    <p class="help-block">{{ error }}</p>
                {% endfor %}
            </div>
            <div class="form-group {{ 'has-error' if form.oxeleven_token.errors else '' }}">
                <div class="input-group">
                    {{ form.oxeleven_token.label(class="control-label") }}
                    <p class="help-block">Static token for accessing oxEleven APIs. The value will be used only if oxEleven is selected as rotation type.</p>
                    {{ form.oxeleven_token(class="form-control") }}
                </div>
                {% for error in form.oxeleven_token.errors %}
                    <p class="help-block">{{ error }}</p>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">LDAP Integration</h3>
        </div>
        <div class="panel-body">
            <div class="form-group {{ 'has-error' if form.inum_appliance.errors else '' }}">
                <div class="input-group">
                    {{ form.inum_appliance.label(class="control-label") }}
                    <p class="help-block">Inum Appliance.</p>
                    {{ form.inum_appliance(class="form-control") }}
                </div>
                {% for error in form.inum_appliance.errors %}
                    <p class="help-block">{{ error }}</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <button type="submit" class="btn btn-primary">Rotate Key</button>
</form>
{% endblock %}
